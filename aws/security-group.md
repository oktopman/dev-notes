# Security Group

## Security Group란
인스턴스에 대한 인바운드 및 아웃바운드 트래픽을 제어하는 가상 방화벽 역할.  
VPC에서 인스턴스를 시작할 때 최대 5개의 보안그룹에 인스턴스를 할당할 수 있다.  
보안그룹은 `서브넷 수준이 아니라 인스턴스 수준에서 작동` 하기때문에 VPC에 있는 서브넷 내의 각 인스턴스들을 서로 다른 보안그룹으로 할당할 수 있다.  
시작할 때 그룹을 지정하지 않으면 인스턴스가 자동으로 VPC의 기본 보안그룹에 할당된다.  

## NACL
Network ACL은 외부간 통신을 담당하는 보안기능으로 서브넷 단위로 설정가능하며 security group은 내부간 통신을 담당한다.  
VPC가 구성되어야만 사용이 가능하다.  
## Security Group 특징
- 보안 장치
NACL 과 함께 방화벽의 역할을 하는 서비스

- Port 허용
트래픽이 지나갈 수 있는 Port 와 Source를 설정 가능. 특정포트를 막는기능은 NACL로 가능하다.  

- 인스턴스 단위
하나의 인스턴스에 하나 이상의 SG 설정 가능
NACL의 경우 서브넷 단위
설정된 인스턴스는 설정한 모든 SG의 룰을 적용 받음

- 설정된 모든 룰을 사용해서 필터링
80, 443, 8080이 인바운드로 열려있을때 사용자가 8080포트로 접속한다면, 리스트를 순회해서 허용되었는지 확인한다.  
NACL의 경우는 80이 첫 행에 설정되어있다면 8080포트를 허용시켜주지 않기 때문에 잘 구별해야 한다.  

- Stateful
인바운드로 들어온 트래픽은 별 다른 아웃바운드 설정 없이 나갈 수 있다. 반대로 NACL은 Stateless 하다.  
stateful 하다는 뜻은 아웃바운드가 열려있지않더라도 인바운드된 트래픽에 대해서는 `상태`를 알고 있기때문에 security 가 나갈 수 있게 해준다.  
NACL은 반대로 아웃바운드 까지 체크하기 때문에 트래픽이 나갈 수 없다. 그래서 `Stateless` 하다.  

외부에서 서버로 접근하기 위해서는 NACL 의 보안정책과 하위의 Security Group 보안정책에 적용된다.  
동일 서브넷의 내부통신은 Security Group 보안정책만 적용된다.  